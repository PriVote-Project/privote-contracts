import { ethers } from "hardhat";
import * as maciContract from "../deployments/localhost/Privote.json";
import * as anonAadhaarContract from "../deployments/localhost/AnonAadhaarGatekeeper.json";
import { anonAadhaar } from "../typechain-types";

async function main() {
  const [deployer] = await ethers.getSigners();
  const maci = new ethers.Contract(maciContract.address, maciContract.abi, deployer);
  const anonAadhaar = new ethers.Contract(anonAadhaarContract.address, anonAadhaarContract.abi, deployer);

  // Define the public key, signUpGatekeeperData, and initialVoiceCreditProxyData
  const pubKey = {
    x: "7241728685366863917285668999330892372683604660822807916359904479991538689337",
    y: "15227291638174786727851591747573626451311594421326528332958841360833178655475",
  };
  // const signUpGatekeeperData =
  // "0x00000000000000000000000000000000000000000000000000000000000011b6055a752ae223d1be3c0fb1ab4396c04ee586ddd993119171a46ef850443f58d90000000000000000000000000000000000000000000000000000000067535ec81621c5aa4ec240e764ddd9bfae2fcd46419e89695f58560e65b3f97c56ff419e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000086d1a1a48e9b0aaedd8e59b5f9df9597465ea9012ff59220f97e560f9e61c0a2611ec83fe95a6840b39dde4452fc9a5839af6bc43ab9cc68c3d49aa538d616f236fe9f80fb8ee6d349904c21c22d1176f5a26ad628d74364629eb80be5b3ccb002781d470a0836dde47324a8391b1994336439a9b41240c80c2cbb93ebc40ed14f95313db78056b410df996cc3d6fc5bb0ace6c5e49e47415ba893563696a062da28fdb17b563bac8b13af1d4d3425a265521d022841f566935195b7991cdf4013fd949c0bb00397b6ee82d51941838d1416aa3ecba29856f0be420309ab4641ce5ae832836a60f5af3d1664051ff6566de611aa6a25c22a4bf9543dde855a3";
  // "0x0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000017184a1fcfbad9fcf2c147b7bf734a83780725ace45a2c2a7ddafa2404e17a5961dc8300000000000000000000000000000000000000000000000000000000675df8d80000000000000000000000009299eac94952235ae86b94122d2f7c77f7f6ad300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000203cb2abf2128389ef94d741fb367c87690fc3c2d9f865885bd48805f00f7c3b2af3afb5d948f23f5a35d4f1a7b14bbcabfbcf7e060ba9699087bed82a9b9d0d2cae2287dc399b35af7ed670c7149e235ef9c0ac50cd67e5758871f5a0f84a141b8fc7d6293cb0b56fa54e64d5770f4e960dfd609352da659c3579b5da93ed57265258a7c0aa14341d5a1029fce3594c9582468a1435ed607ce7ba6fe363246812a4742be75a5946ca8a5b9cb92477ed5b1357f0d62d231ce7800768cbc09d38284599b1e99e8e81f1a242f82931f237247b64df462e9bedd5d52528d9f44d8b00f25ad7c36a9f2f3020634462211226113eb0dc4afa329448c2e502ac9939b6";

  //			uint256 providedNullifierSeed,
  // uint256 nullifier,
  // uint256 timestamp,
  // uint256 signal,
  // uint256[4] memory revealArray,
  // uint256[8] memory groth16Proof
  const nullifierSeed = "107839786668602559178668060348078522694548577690162289924414440996864";
  const nullifier = "40805122788415343634886363950242022925393775161151769192950215614920974714";
  const timestamp = "40428749605143519165962478862167395905819816534850834218637602271678611587072";
  const signal = "46754257637543311909461114634687470346058351246709399946008238072615536655479";
  const revealArray = ["112157113274197715264054495108939879650042569182305657982464840655316927381504", "0", "0", "0"];
  const groth16Proof = [
    "3394963016045518922585756192921408182994683872393000011249447372805",
    "108582443777662827373916573623257090864623402199907367736789653340422463274712",
    "19272084864898966444600100078416713336886612771654228483404154775002428240373",
    "72808745116718837086158575592226862187492607785764394770695403298391779015093",
    "98865565573109786957934954872060423077262672206154552530469829495699836222063",
    "102850185756480741670621681793889171719992106659893648431728834175813229217640",
    "92159827987015109708667440546107200711989629148102092578823137413272823997736",
    "98583534008375720665290619097567699024247878302458969753176374063254875596034",
  ];

  const encodedSignupData =
    "0x00000004000000000000000000000000000000000000000000000000000000000017184a1fcfbad9fcf2c147b7bf734a83780725ace45a2c2a7ddafa2404e17a5961dc8300000000000000000000000000000000000000000000000000000000675df8d80000000000000000000000009299eac94952235ae86b94122d2f7c77f7f6ad300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000203cb2abf2128389ef94d741fb367c87690fc3c2d9f865885bd48805f00f7c3b2af3afb5d948f23f5a35d4f1a7b14bbcabfbcf7e060ba9699087bed82a9b9d0d2cae2287dc399b35af7ed670c7149e235ef9c0ac50cd67e5758871f5a0f84a141b8fc7d6293cb0b56fa54e64d5770f4e960dfd609352da659c3579b5da93ed57265258a7c0aa14341d5a1029fce3594c9582468a1435ed607ce7ba6fe363246812a4742be75a5946ca8a5b9cb92477ed5b1357f0d62d231ce7800768cbc09d38284599b1e99e8e81f1a242f82931f237247b64df462e9bedd5d52528d9f44d8b00f25ad7c36a9f2f3020634462211226113eb0dc4afa329448c2e502";

  const initialVoiceCreditProxyData = "0x";

  const trait = await anonAadhaar.getTrait();
  console.log(trait);

  // run the signUp function
  const signUpTx = await maci.signUp(pubKey, encodedSignupData, initialVoiceCreditProxyData);

  await signUpTx.wait(1);
  console.log("User signed up");
}

main().catch(error => {
  console.error(error);
  process.exitCode = 1;
});
